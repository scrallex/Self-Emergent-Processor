<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SEP Architecture - Self-Emergent Processor</title>
    
    <!-- CSS -->
    <link rel="stylesheet" href="assets/css/main.css">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- Mermaid -->
    <script src="https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.min.js"></script>
    
    <style>
        body {
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
        }
        
        .architecture-page {
            flex: 1;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
            width: 100%;
        }
        
        .page-header {
            text-align: center;
            margin-bottom: 3rem;
        }
        
        .page-title {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .page-subtitle {
            font-size: 1.125rem;
            color: var(--text-secondary);
        }
        
        .mermaid-full {
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
            overflow-x: auto;
        }
        
        .mermaid {
            display: flex;
            justify-content: center;
        }
        
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            color: var(--accent-primary);
            text-decoration: none;
            margin-bottom: 2rem;
            transition: color 0.3s ease;
        }
        
        .back-link:hover {
            color: var(--accent-secondary);
        }
        
        .architecture-description {
            margin-top: 3rem;
            background: var(--bg-secondary);
            border: 1px solid var(--border-color);
            border-radius: 12px;
            padding: 2rem;
        }
        
        .architecture-description h2 {
            margin-bottom: 1rem;
            color: var(--text-primary);
        }
        
        .architecture-description p {
            color: var(--text-secondary);
            line-height: 1.8;
            margin-bottom: 1rem;
        }
        
        .component-list {
            list-style: none;
            padding: 0;
            margin-top: 1.5rem;
        }
        
        .component-list li {
            padding: 0.5rem 0;
            color: var(--text-secondary);
        }
        
        .component-list strong {
            color: var(--text-primary);
        }
    </style>
</head>
<body>
    <div class="architecture-page">
        <a href="index.html" class="back-link">
            <svg width="20" height="20" viewBox="0 0 20 20" fill="currentColor">
                <path d="M12.707 5.293a1 1 0 010 1.414L9.414 10l3.293 3.293a1 1 0 01-1.414 1.414l-4-4a1 1 0 010-1.414l4-4a1 1 0 011.414 0z"/>
            </svg>
            Back to Main Page
        </a>
        
        <div class="page-header">
            <h1 class="page-title">SEP System Architecture</h1>
            <p class="page-subtitle">Complete architectural overview of the Self-Emergent Processor</p>
        </div>
        
        <div class="mermaid-full">
            <pre class="mermaid">
graph TB
    %% Main Executable
    subgraph "Executable Layer"
        exe[sep_engine<br/>Final Binary]
    end

    %% Static Libraries with detailed component mapping
    subgraph "Static Library Layer"
        subgraph "API & Interface"
            api[libsep_api.a<br/>HTTP/C Bridge/Rate Limiting<br/>└─ server.cpp<br/>└─ bridge_c.cpp<br/>└─ crow_adapter.cpp<br/>└─ sep_engine.cpp]
        end

        subgraph "Domain Components"
            blender[sep_blender<br/>Cycles Integration<br/>└─ cycles_renderer.cpp<br/>└─ mesh_handler.cpp<br/>└─ gpu_context.cpp]
            audio[libsep_audio.a<br/>PipeWire Integration<br/>└─ pipewire_capture.cpp<br/>└─ pipeline.cpp]
        end

        subgraph "Quantum Processing"
            quantum[libsep_quantum.a<br/>QBSA/QFH Algorithms<br/>└─ processor.cpp<br/>└─ evolution.cpp<br/>└─ pattern_processor.cpp<br/>└─ qfh.cpp]
        end

        subgraph "Memory Management"
            memory[libsep_memory.a<br/>Tiered Storage<br/>└─ memory_tier_manager.cpp<br/>└─ quantum_coherence_manager.cpp<br/>└─ redis_manager.cpp]
        end

        subgraph "CUDA Backend"
            compat[libsep_compat.a<br/>GPU Abstraction<br/>└─ core.cu<br/>└─ stream.cpp<br/>└─ cuda_api.cu<br/>└─ quantum_kernels.cu<br/>└─ pattern_kernels.cu]
        end

        subgraph "Core Foundation"
            core[libsep_core.a<br/>Base Infrastructure<br/>└─ engine.cpp<br/>└─ manager.cpp<br/>└─ metrics_collector.cpp<br/>└─ logging.cpp<br/>└─ dag_graph.cpp]
        end
    end

    %% External Dependencies
    subgraph "Cycles Dependencies"
        cycles_kernel[libcycles_kernel.a]
        cycles_scene[libcycles_scene.a]
        cycles_device[libcycles_device.a]
        cycles_osl[libcycles_osl.a]
        osl_exec[liboslexec.so]
        osl_comp[liboslcomp.so]
        osl_query[liboslquery.so]
    end

    subgraph "System Libraries"
        cuda_runtime[CUDA Runtime<br/>cudart/cuda_driver]
        pthread[pthread]
        redis[hiredis]
        pipewire[pipewire-0.3]
    end

    %% Dependency Arrows with Link Order
    exe -.->|1| compat
    exe -.->|2| cycles_kernel
    exe -.->|3| cycles_scene
    exe -.->|4| cycles_device
    exe -.->|5| cycles_osl
    exe -.->|6| osl_exec
    exe -.->|7| osl_comp
    exe -.->|8| osl_query
    exe ==>|9| api
    exe ==>|10| memory
    exe ==>|11| quantum
    exe ==>|12| core
    exe ==>|13| audio
    exe ==>|14| blender

    %% Internal Dependencies
    api --> quantum
    api --> memory
    api --> core

    blender --> quantum
    blender --> memory
    blender --> cycles_kernel
    blender --> cycles_scene
    blender --> cycles_device
    blender --> cycles_osl
    blender --> core

    audio --> quantum
    audio --> memory
    audio --> core

    quantum --> compat
    quantum --> core
    quantum -.->|manifold symbols| memory

    memory --> core
    memory --> redis

    compat --> cuda_runtime


    %% Symbol Conflicts
    quantum x--x|multiple defs<br/>manifold::memory<br/>manifold::quantum<br/>manifold::cuda<br/>manifold::api| memory


    %% Styling
    classDef conflict fill:#ffaa66,stroke:#ff6600,stroke-width:3px
    classDef critical fill:#66ff66,stroke:#00ff00,stroke-width:2px
    
    class quantum,memory conflict
    class compat,core critical
            </pre>
        </div>
        
        <div class="architecture-description">
            <h2>Architecture Overview</h2>
            <p>
                The SEP engine is built with a modular, high-performance architecture designed for quantum-inspired computation. 
                The system leverages CUDA for GPU acceleration, integrates with Blender's Cycles renderer for visual processing, 
                and uses PipeWire for audio capture and analysis.
            </p>
            
            <h3>Key Components</h3>
            <ul class="component-list">
                <li><strong>API Layer:</strong> HTTP server with C bridge and rate limiting for external communication</li>
                <li><strong>Quantum Processing:</strong> QBSA and QFH algorithms for pattern recognition and evolution</li>
                <li><strong>Memory Management:</strong> Tiered storage with Redis integration for efficient data handling</li>
                <li><strong>CUDA Backend:</strong> GPU abstraction layer with optimized quantum and pattern kernels</li>
                <li><strong>Domain Components:</strong> Cycles integration for rendering and PipeWire for audio processing</li>
                <li><strong>Core Foundation:</strong> Base infrastructure including DAG graph, metrics, and logging</li>
            </ul>
            
            <h3>Design Principles</h3>
            <p>
                The architecture follows a clear separation of concerns with static libraries for each major component. 
                The linking order is carefully managed to resolve dependencies, with some intentional symbol conflicts 
                between the quantum and memory modules that represent the quantum superposition states in the system.
            </p>
        </div>
    </div>
    
    <script>
        mermaid.initialize({ 
            startOnLoad: true,
            theme: 'dark',
            themeVariables: {
                primaryColor: '#7c3aed',
                primaryBorderColor: '#6d28d9',
                primaryTextColor: '#fff',
                lineColor: '#4ade80',
                secondaryColor: '#1e293b',
                tertiaryColor: '#334155',
                background: '#0f172a',
                mainBkg: '#1e293b',
                secondBkg: '#334155',
                tertiaryBkg: '#475569',
                darkMode: true
            }
        });
    </script>
</body>
</html>